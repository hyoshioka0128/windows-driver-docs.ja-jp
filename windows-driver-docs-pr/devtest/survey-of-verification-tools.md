---
title: 検証ツールの調査
description: 検証ツールの調査
ms.assetid: d36e041f-efa5-450f-b4de-c84c4880e44d
keywords:
- 動的検証ツール WDK
- 静的検証ツール WDK
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: c097fdc41ff1b2504e95069ae2f1b85ff5eb8bf0
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72840001"
---
# <a name="survey-of-verification-tools"></a>検証ツールの調査


次の検証ツールは、WDK で記述されており、ドライバーの開発者およびテスト担当者が使用することをお勧めします。 これらは、通常使用される順序で一覧表示されます。

### <a name="span-idas_soon_as_the_code_compilesspanspan-idas_soon_as_the_code_compilesspanas-soon-as-the-code-compiles"></a><span id="as_soon_as_the_code_compiles"></span><span id="AS_SOON_AS_THE_CODE_COMPILES"></span>コードがコンパイルされるとすぐに

-   [ドライバーのコード分析](code-analysis-for-drivers.md)は、コンパイル時に実行される静的な検証ツールです。 Windows Driver Kit には、Microsoft Visual Studio Ultimate 2012 の[コード分析ツール](https://go.microsoft.com/fwlink/p/?linkid=226836)にドライバー固有の拡張機能が用意されています。

    [ドライバーのコード分析](code-analysis-for-drivers.md)では、C/C++およびマネージコードで記述されたドライバーを確認できます。 ドライバーの各関数のコードを個別に調べるため、ドライバーをビルドできるようになったらすぐに実行できます。 比較的高速に実行され、いくつかのリソースを使用します。

    [コード分析ツール](https://go.microsoft.com/fwlink/p/?linkid=226836)の基本的な機能では、戻り値をチェックしないなど、一般的なコーディングエラーが検出されます。 ドライバー固有の機能は、初期化されていないフィールドをコピーされた IRP に残し、ルーチンの終了によって変更された IRQL の復元に失敗するなど、より微妙なドライバーコードエラーを検出します。

<!-- -->

-   [Static Driver Verifier](static-driver-verifier.md) (sdv) は、コンパイル時に実行され、C/C++で記述されたカーネルモードドライバーコードを検証する静的な検証ツールです。 これは WDK に含まれており、Visual Studio Ultimate 2012 から、または MSBuild を使用して Visual Studio コマンドプロンプトウィンドウから起動できます。

    静的ドライバーの検証ツールは、一連のインターフェイス規則とオペレーティングシステムのモデルに基づいて、ドライバーが Windows オペレーティングシステムのカーネルと適切に対話するかどうかを判断します。 静的ドライバーの検証ツールは非常に詳細であり、ドライバーのソースコード内のすべての到達可能なパスを調べて、シンボルとして実行します。 そのため、他の従来のドライバーテスト方法を使用しても検出されないバグが検出されます。

### <a name="span-idwhen_the_driver_runsspanspan-idwhen_the_driver_runsspanwhen-the-driver-runs"></a><span id="when_the_driver_runs"></span><span id="WHEN_THE_DRIVER_RUNS"></span>ドライバーの実行時

ドライバーが構築され、明らかなエラーなしで実行されている場合は、すぐに次の動的検証ツールを使用します。

-   [Windows のビルドを確認](checked-build-of-windows.md)しました。 技術的には検証ツールではありませんが、Windows のチェックされたビルドでドライバーを実行すると、他のツールを使用したテストでは明らかにならないエラーを検出するのに役立ちます。 カーネルデバッガーと共にチェックされたビルドでを実行することは、ドライバーの開発とテストの標準的な部分です。

-   [Driver Verifier](driver-verifier.md)は、特に Windows ドライバー用に作成された動的検証ツールです。 複数のドライバーで同時に実行できる複数のテストが含まれています。 ドライバーの検証ツールは、ドライバーの開発者やテスト担当者が、ドライバーが開発環境またはテスト環境で実行されるたびに実行されるようにドライバーの検証ツールを構成しているドライバーで、深刻なバグを発見するうえで効果的です。 ドライバーの検証ツールは、windows 2000 以降のバージョンの Windows に含まれています。 ドライバーのドライバーの検証機能を有効にする場合は、ドライバーに対して複数のテストを実行する必要もあります。 ドライバーの検証ツールは、静的な検証ツールだけを使用して検出しにくい特定のドライバーバグを検出できます。 この種のバグの例を次に示します。
    -   **カーネルプールのバッファーオーバーラン。** 検証されたドライバーがプールのメモリバッファーを割り当てると、ドライバーの検証ツールは、アクセスできないメモリページでそれらを保護します。 ドライバーがバッファーの末尾を越えてメモリを使用しようとすると、ドライバー検証ツールはバグチェックを発行します。
    -   **メモリを解放した後に使用します。** 特別なプールメモリブロックでは独自のメモリページが使用され、メモリページは他の割り当てとは共有されません。 ドライバーがプールメモリのブロックを解放すると、対応するメモリページがアクセス不可能になります。 ドライバーが解放された後にそのメモリを使用しようとすると、ドライバーが即座にクラッシュします。
    -   **管理者特権での IRQL での実行中に、ページング可能なメモリを使用します。** 検証されたドライバーがディスパッチ\_レベル以上で IRQL を発生させると、ドライバー検証ツールは、システムワーキングセットからすべてのページング可能なメモリをトリムし、メモリ不足のシステムをシミュレートします。 これらのページング可能な仮想アドレスの1つを使用しようとすると、ドライバーがクラッシュします。
    -   **低リソースシミュレーション。** リソース不足の状態でシステムをシミュレートするために、ドライバーの検証ツールは、ドライバーによって呼び出されたさまざまなオペレーティングシステムのカーネル Api を失敗させることができます。
    -   **メモリリーク。** ドライバーの検証ツールは、ドライバーによって行われたメモリの割り当てを追跡し、ドライバーがアンロードされる前にメモリが解放されるようにします。
    -   **完了またはキャンセルに時間がかかりすぎる i/o 操作。** ドライバーの検証ツールは、 [**IoCallDriver**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iocalldriver)からの保留中の戻り値\_状態に応答するために、ドライバーのロジックをテストできます。
    -   **DDI 準拠の確認。** (Windows 8 以降で利用可能)ドライバーの検証ツールは、ドライバーとオペレーティングシステムのカーネルインターフェイスとの間の適切な対話を確認する一連のデバイスドライバーインターフェイス (DDI) 規則を適用します。 これらの規則は、ドライバーのソースコードを分析するときに、静的ドライバーの検証ツールで使用される規則に対応しています。 DDI 準拠の確認が有効になっているときに Driver Verifier によってエラーが検出された場合は、[静的ドライバー検証ツール](static-driver-verifier.md)を実行し、エラーの原因となったルールを選択します。 静的ドライバーの検証ツールを使用すると、ドライバーのソースコード内の不具合の原因を見つけることができます。
-   [アプリケーション検証ツール](application-verifier.md)は、C/C++で記述されたユーザーモードアプリケーションとドライバー用の動的検証ツールです。 マネージコードは検証されません。 アプリケーション検証ツールは WDK には含まれていませんが、 [Microsoft ダウンロードセンター](https://go.microsoft.com/fwlink/p/?linkid=11573)からダウンロードしてインストールすることができます。

 

 





