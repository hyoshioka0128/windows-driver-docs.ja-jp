---
title: サービス アプリケーションの自動デバッグ
description: サービス アプリケーションの自動デバッグ
ms.assetid: 3168b5c1-30fa-4ff5-b871-736dcdeb8f31
ms.date: 11/28/2017
ms.localizationpriority: medium
ms.openlocfilehash: d59b794c0e186e9618b112e29fc7e6f27d029b4a
ms.sourcegitcommit: dadc9ced1670d667e31eb0cb58d6a622f0f09c46
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/09/2020
ms.locfileid: "84534394"
---
# <a name="debugging-the-service-application-automatically"></a>サービス アプリケーションの自動デバッグ


デバッガーは、サービスアプリケーションの起動時に自動的に起動できます。 または、サービスアプリケーションが例外を検出したとき、または**DebugBreak**コマンドを実行したときに、自動的に起動されるようにすることもできます。 これらの方法のいずれかを選択した場合、このトピックでは、次の手順を実行する方法について説明します。 どの方法を選択すればよいかわからない場合は、「[最適な方法の選択](choosing-the-best-method.md)」を参照してください。

その後、次の手順を使用します。

1.  次のいずれかの準備手順を実行します。
    -   初期化コードを含めて、最初からサービスアプリケーションをデバッグする場合は、「初期化コードのデバッグを有効にする」で説明されている手順に従ってください。 または、サービスアプリケーションがクラッシュしたとき、または例外が発生したときにデバッガーを中断する場合は、「サービスアプリケーションを有効にする」で説明されている手順に従ってデバッガーを中断します。
    -   サービスアプリケーションでデバッガーが正常に実行できるようにするには、「[サービスアプリケーションタイムアウトの調整](preparing-to-debug-the-service-application.md#adjusting-the-service-application-timeout)」で説明されている手順を実行します。
    -   サービスが1つの SvcHost プロセスで他のサービスと結合されている場合は、「サービスの分離」で説明されている手順を実行します。

2.  サービスが既に実行されている場合、これらの変更を有効にするには、サービスを再起動する必要があります。 実行中のサービスの影響を排除するために、Windows 自体を再起動することをお勧めします。 Windows を再起動しない場合は、次のコマンドを使用します。ここで、 *ServiceName*はサービスの名前です。

    ```console
    net stop ServiceName 
    net start ServiceName 
    ```

3.  サービスアプリケーションの初期化コードをデバッグすることを選択した場合、サービスが開始されると、デバッガーが起動し、サービスアプリケーションにアタッチされます。

    デバッガーが例外によってトリガーされるように選択した場合、サービスアプリケーションは、例外が発生するか、 **DebugBreak**関数を実行するまで、通常どおりに実行されます。 この時点で、デバッガーが起動し、サービスアプリケーションにアタッチされます。

4.  次の手順は、手順1で指定したデバッガーのコマンドラインによって異なります。
    -   リモート処理オプションを指定せずにデバッガーを指定した場合、デバッガーが起動し、ウィンドウが表示されます。
    -   -Server オプションと-noio オプションで NTSD を指定した場合、コンソールウィンドウなしで NTSD が起動されます。 次に、-remote パラメーターを使用してユーザーモードのデバッガーを起動することで、別のコンピューターからデバッグセッションに接続できます。 手順については、「[**デバッグクライアントのアクティブ化**](activating-a-debugging-client.md)」を参照してください。
    -   -D オプションを使用して NTSD を指定した場合は、コンソールウィンドウなしで NTSD が起動されます。 その後、別のコンピューターで実行されているカーネルデバッガーを使用して、デバッグセッションに接続できます。 手順については、「[カーネルデバッガーからのユーザーモードデバッガーの制御](controlling-the-user-mode-debugger-from-the-kernel-debugger.md)」を参照してください。
    -   -Ddefer オプションと-server オプションを使用して NTSD を指定した場合、コンソールウィンドウなしで NTSD が起動されます。 その後、カーネルデバッガーとユーザーモードのリモートデバッガーの両方を使用して、デバッグセッションに接続できます。これは、サービスとは別のコンピューター上で実行されます (ただし、同じコンピューターである可能性があります)。 手順については、「[このメソッドとリモートデバッグの組み合わせ](combining-this-method-with-remote-debugging.md)」を参照してください。

5.  デバッガーが起動すると、サービスは最初のプロセスブレークポイント、例外、または**DebugBreak**コマンドで一時停止します。 これにより、サービスアプリケーションの現在の状態の確認、ブレークポイントの設定、およびその他の必要な構成選択を行うことができます。

6.  [**G (on)**](g--go-.md)または別の実行コマンドを使用して、サービスアプリケーションの実行を再開します。

## <a name="span-idrelated_topicsspanrelated-topics"></a><span id="related_topics"></span>関連トピック


[DebugBreak 関数](https://docs.microsoft.com/windows/win32/api/debugapi/nf-debugapi-debugbreak)

 

 






