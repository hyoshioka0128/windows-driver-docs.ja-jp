---
title: 電源管理
description: 電源管理
ms.assetid: b47ed463-2292-419a-af16-196382dbd3f1
keywords:
- 電源管理の WDK プリンター
- 重大なシャットダウンの WDK プリンター
- 電源管理のシャットダウンの WDK プリンター
- スタンバイテストの WDK プリンター
- 休止状態テストの WDK プリンター
ms.date: 06/11/2020
ms.localizationpriority: medium
ms.openlocfilehash: 57a021c2c2520d0e0ad404bc986f70ab523040f6
ms.sourcegitcommit: adccef85b24a37b1caa51e1b3435741a2f022cd5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/12/2020
ms.locfileid: "84724409"
---
# <a name="power-management"></a>電源管理

ポート接続デバイスの一般的なエラーのいくつかは、システムがさまざまなスリープ状態を使用していて、デバイスがデバイスの電源状態を正しく設定できない場合、またはデバイスがさまざまな電源状態から戻ることができない場合に発生します。 システムは、完全な電源オフ状態 ("コールドブート") から起動された場合と同じように動作する必要があります。 スリープ状態からの入力またはスリープ解除に固有の特殊な動作は、おそらくバグの可能性があります。

デバイスが正常に動作していることを確認するには、次の基本的な規則に従います。

1. デバイス、ポート、およびそのドライバーは、システムがスリープ状態にならないようにする必要があります。

1. 進行中の印刷ジョブは、低電力状態への要求をブロックしないようにする必要があります。

1. システムがスリープ状態から復帰すると、より低い電力状態が開始されたときに進行中だった印刷ジョブは、正常に再開されます。

1. 重大なシャットダウン要求は、電源状態の変更を拒否する試行を上書きします。

詳細については、「[システム電源状態](https://docs.microsoft.com/windows-hardware/drivers/kernel/system-power-states)」を参照してください。

## <a name="testing-port-connected-devices-across-various-power-states"></a>さまざまな電源状態でのポート接続デバイスのテスト

さまざまな電源状態の前後にデバイスのテストを開始するには、まず、デバイスのベースライン[プラグアンドプレイ](https://docs.microsoft.com/windows-hardware/drivers/kernel/implementing-plug-and-play)(PnP) 機能を確認します。 次に、テスト環境がすべての電源状態を入力および復帰できることを確認します。

1つのデバイスが正常に接続され、インストールされている状態で、各電源状態 S0 の前後の動作を次のようにテストします。

- **スタンバイテスト (S1-S3)**

    1. デバイスが接続されていて、進行中のジョブがない状態で、スタンバイ状態を入力してスリープ解除します。 システムは各スリープ状態とウェイク状態を適切に入力する必要があります。

    1. スリープ状態に入る前と後の両方で、デバイスが正常に機能していることを確認します。 デバイスがインストールされていない状態で同じテストを繰り返します。

    1. スタンバイ状態からのスリープ解除後にデバイスをインストールしてみてください。 デバイスは正常にインストールされます。

    1. 印刷ジョブが進行中のスタンバイからの入力とスリープ解除を確認します。 進行中のジョブは、スリープ解除時に再開されます。

    1. ジョブをキャンセル、回復、およびスタンバイ状態からの復帰後に再開できることを確認します。

    1. 「[デバイスエラーの状態](device-error-states.md)」で説明されている各エラー状態にデバイスを配置します。 ジョブをキャンセル、回復、およびスタンバイ状態からの復帰後に再開できることを確認します。

- **休止状態テスト (S4)**

    1. デバイスが接続されていて、進行中のジョブがない状態で、休止状態から復帰します。 システムは各スリープ状態とウェイク状態を適切に入力する必要があります。

    1. スリープ状態に入る前と後の両方で、デバイスが正常に機能していることを確認します。 デバイスがインストールされていない状態で同じテストを繰り返します。

    1. 休止状態から復帰した後、デバイスをインストールしてみてください。 デバイスは正常にインストールされます。

    1. 印刷ジョブが進行中である休止状態からの入力とスリープ解除を確認します。 進行中のジョブは、スリープ解除時に再開されます。

    1. 「[デバイスエラーの状態](device-error-states.md)」で説明されている各エラー状態にデバイスを配置します。 ジョブが取り消され、から回復され、休止状態から復帰した後に再開できることを確認します。

- **シャットダウン/再起動 (S5)**

    1. デバイスが接続されていて、進行中のジョブがないときにシステムをシャットダウンします。 システムを正常にシャットダウンする必要があります。

    1. システムをシャットダウンする前と後の両方で、デバイスが正常に機能することを確認します。 デバイスがインストールされていない状態で同じテストを繰り返します。

    1. シャットダウンしてからシステムを再起動した後、デバイスをインストールしてみてください。

    1. 印刷ジョブが進行中のシステムをシャットダウンして再起動します。 進行中のジョブは再起動時に再開されます。

    1. 「[デバイスエラーの状態](device-error-states.md)」で説明されている各エラー状態にデバイスを配置します。 システムのシャットダウンまたは再起動後にジョブを取り消し、回復し、再起動できることを確認します。 エラー状態の印刷ジョブは、シャットダウンまたは再起動によってキューに保持され、シャットダウンまたは再起動後にエラー状態がクリアされた後で、印刷ジョブが再開されます。

- **重大なシャットダウン**

    1. 重要なシャットダウンイベントが要求された場合 (たとえば、重大なバッテリレベルに達した場合など)、コンピューターは上記のアクティブな電源状態 (S0-S4) にある可能性があります。 重大なシャットダウンイベントの前後に、デバイスが正常に機能していることを確認します。 デバイスがインストールされていない状態で同じテストを繰り返します。

    1. 重大なシャットダウンイベントの後にデバイスをインストールしてみてください。

    1. 重大なシャットダウンイベントが電源マネージャーによって開始されたときにデバイスが使用されている状態をテストし、デバイスドライバーがスリープ状態を拒否しないようにします。

    1. 印刷ジョブが進行中であるため、重大なシャットダウンイベントを開始します。 システムのスリープ状態を解除すると、印刷ジョブが再起動され、正常に回復されます。

    1. 「[デバイスエラーの状態](device-error-states.md)」で説明されている各エラー状態にデバイスを配置します。 重大なシャットダウンイベントから復帰した後で、ジョブを取り消し、復旧し、再起動できることを確認します。 エラー状態の印刷ジョブは、シャットダウンまたは再起動によってキューに保持され、シャットダウンまたは再起動後にエラー状態がクリアされた後で、印刷ジョブが再開されます。

    1. デバイスがインストールされ、アイドル状態の場合は、コントロールパネルから取得した**電源オプション**アプリケーションを使用して、システムのスリープ状態を開始します。 指定された時間に、システムが適切なスリープ状態に入ることを確認します。 デバイスがインストールされていない状態でこのテストを繰り返し、システムのスリープ解除後にデバイスをインストールできることを確認します。
