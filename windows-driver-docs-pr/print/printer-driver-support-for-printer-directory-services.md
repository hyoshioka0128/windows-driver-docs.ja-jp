---
title: プリンター ディレクトリ サービスの印刷ドライバー サポート
description: プリンター ディレクトリ サービスの印刷ドライバー サポート
ms.assetid: 6b0b3cda-a9e5-458d-b5e2-89667059bde4
keywords:
- ディレクトリサービス WDK プリンター
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: ec8d860a59d3aa59eebdcf9d6cba31e68fef9a2d
ms.sourcegitcommit: 88f6e7355de9e0714057020557dc8c7831e90e7b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/10/2020
ms.locfileid: "84638446"
---
# <a name="printer-driver-support-for-printer-directory-services"></a>プリンター ディレクトリ サービスの印刷ドライバー サポート





プリンタードライバーは、印刷キューをディレクトリサービスに発行する役割を持ちません。 Microsoft Windows 2000 以降の印刷フォルダーは、プリンターのインストール処理中に (スプーラの**Setprinter**関数を呼び出すことによって) 印刷キューオブジェクトを作成します。

印刷キューのプロパティは、ユーザーがタスクバーの [**スタート**] メニューの [**検索**] オプションを使用して、特定のプロパティを持つプリンターを検索できるように公開されます。 印刷フォルダは、ドライバ機能から使用できるプリンタ機能の一部を公開しますが、すべてではありません。 参照のために役に立つと思われる機能のみが公開されています。

プリンタードライバーは、印刷キューオブジェクトのプロパティ情報を追加または変更できます。 発行できる印刷キューのプロパティは、winspool に定義されている、プレフィックスが付いた定数**によって \_ **識別されます。 プリンターのプロパティを追加または変更するには、ドライバーでこれらの定義済みプロパティ名識別子を使用する必要があります。

印刷キューオブジェクトのプロパティ情報を追加または変更するには、次の手順を実行します。

1.  \_ \_ スプーラの**Setプリンター dataex**関数を呼び出して、プロパティの名前と値をレジストリのレジストリに追加します。

1.  発行され**SetPrinter** \_ \_ \_ た印刷キューオブジェクトを更新する必要があることをスプーラに通知するには、(Windows SDK のドキュメントで説明されている) プリンタ情報7の入力構造と共にスプーラの setprinter 関数を呼び出します。 (ドライバーは DSPRINT \_ のアクションを指定することはできません。PUBLISH。)

これらの手順は、プリンタードライバーの[**DrvPrinterEvent**](https://docs.microsoft.com/windows-hardware/drivers/ddi/winddiui/nf-winddiui-drvprinterevent)関数内に実装する必要があります。この関数は、printer \_ イベント \_ INITIALIZE イベントを受け取ります。

ドライバーがプリンターの公開されたプロパティの現在の値を取得する必要がある場合は、 **Getprinter dataex**または**Enumprinter dataex**を呼び出して、レジストリから情報を取得する必要があります。この情報は、スプーラによって保持され、常に最新の状態にあります。 別の方法として、 **Getprinter**を呼び出して印刷キューのオブジェクト識別子を取得し、次に ADSI 関数を呼び出して、公開されているプロパティの値を取得します。 この手法は、リソースを大量に消費し、返されるデータが常に最新であるとは限りません。そのため、この方法はお勧めしません。
