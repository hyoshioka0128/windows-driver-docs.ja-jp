---
title: プリンター ディレクトリ サービスの印刷スプーラー サポート
description: プリンター ディレクトリ サービスの印刷スプーラー サポート
ms.assetid: 23cd73a5-8628-4471-a6c6-e056536fcc75
keywords:
- ディレクトリサービス WDK プリンター
- 印刷スプーラディレクトリサービスサポート WDK
- WDK プリンターの発行
ms.date: 06/09/2020
ms.localizationpriority: medium
ms.openlocfilehash: 71565b5891304d4493d95ff330aeeba699728517
ms.sourcegitcommit: 88f6e7355de9e0714057020557dc8c7831e90e7b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/10/2020
ms.locfileid: "84638450"
---
# <a name="print-spooler-support-for-printer-directory-services"></a>プリンター ディレクトリ サービスの印刷スプーラー サポート

印刷スプーラでのディレクトリサービスのサポートは次のとおりです。

- 印刷キューの公開

- 3つのレジストリキーの保持

- スプーラによって維持されるレジストリキーへのアクセスを許可する

- 印刷キューのパブリケーション状態を返す

## <a name="publishing-print-queues"></a>印刷キューの公開

**Setprinter**関数を使用すると、呼び出し元は印刷キューオブジェクトの発行、発行の取り消し、または更新を行うことができます。 このためには、プリンター情報7の入力構造で**Setprinter**関数を呼び出す必要があり \_ \_ ます。

印刷キューオブジェクトを公開できるのは、ユーザーが接続されているプリントサーバーを記述するコンピュータオブジェクトに関連付けられている場合のみです。 ユーザーが印刷キューを公開できるかどうかは、ユーザーのクライアントのセキュリティコンテキストに含まれるアクセス権によって決まります。 印刷キューに対する "プリンターの管理" アクセス許可を持っている場合は、印刷キューを公開できます。

## <a name="maintaining-three-registry-keys"></a>3つのレジストリキーの保持

3つのレジストリキーには、印刷キューオブジェクトに公開されているすべての情報のコピーが含まれます。 この3つのキーは、winspool で定義されている次の識別子を使用して参照されます。

| キー | 定義 |
| --- | --- |
| SPLDS_DRIVER_KEY | ドライバー固有の情報を格納するために使用します。この情報は、スプーラまたはドライバーによって提供されます。 |
| SPLDS_SPOOLER_KEY | スプーラによって提供されるスプーラ固有の情報を格納します。 |
| SPLDS_USER_KEY | アプリケーションによって提供されるユーザー固有の情報を格納します。 |

スプーラは、 \_ \_ **DeviceCapabilities**関数を呼び Microsoft Windows SDK 出すことによって取得できるドライバー機能を格納するために、ドライブキーを使用します。 ドライバーは、「プリンター[ドライバーでのプリンターディレクトリサービスのサポート](printer-driver-support-for-printer-directory-services.md)」で説明されているように、スプーラが取得できないドライバー機能を格納する役割を担います。 これらのキーの下に格納される値は、winspool. h で定義されている、プレフィックスが付いた定数**によって \_ **識別される必要があります。

スプーラは、最後に印刷キューオブジェクトが更新されてから、これらのキーの下にあるどの値が変更されたかを追跡します。 スプーラが印刷キューオブジェクトを公開または更新するたびに、変更されたすべての値がオブジェクトにコピーされます。

## <a name="allowing-access-to-spooler-maintained-registry-keys"></a>スプーラによって維持されるレジストリキーへのアクセスを許可する

スプーラを使用すると、プリンタードライバーは、 **Setprinter dataex**、 **getprinter dataex** 、および**enumprinter dataex**の各関数を呼び出すことによって、3つのスプーラで保持されるレジストリキーにアクセスできるようになります。これらの機能については、Microsoft Windows SDK のドキュメントを参照してください。 **Setプリンター dataex**関数は、キーの下に値を設定します。 **getプリンター Dataex**および**enumプリンター dataex**は、現在の値を返します。 (ドライバーでは、 \_ 値を設定しないでくださいスプーラ \_ キーキー)これらの関数の呼び出し元は、完全なレジストリパスを指定していません。関数は、指定された印刷キューのレジストリエントリへのパスを自動的に決定します。

## <a name="returning-a-print-queues-publication-state"></a>印刷キューのパブリケーション状態を返す

**Getprinter**関数を使用すると、印刷キューが現在発行されているかどうかを呼び出し元が判断できます。 このため、 **getprinter**関数は、プリンター情報7の入力構造を使用して呼び出す必要があり \_ \_ ます。 関数は、印刷キューのパブリケーションの状態 (公開またはパブリッシュされていない) とオブジェクト識別子を返します。

前述のすべての関数については、Windows SDK のドキュメントを参照してください。 関数は、DS 関連の操作専用に使用されません。
