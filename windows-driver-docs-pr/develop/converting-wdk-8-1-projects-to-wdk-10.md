---
ms.assetid: 51CD05AB-2626-4E27-AA08-09547D546218
title: WDK 8.1 プロジェクトから WDK 10 への変換
description: Microsoft Visual Studio 2013 と Windows Driver Kit (WDK) 8.1 を使って作成したドライバー プロジェクトを、Microsoft Visual Studio 2015 と Windows Driver Kit (WDK) 10 でビルドするドライバー プロジェクトに変換する方法を説明します。
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 8d3fa096f10d2cfe3a6bc592c0c98f21317fd68b
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56518765"
---
# <a name="converting-wdk-81-projects-to-wdk-10"></a>WDK 8.1 プロジェクトから WDK 10 への変換

ここでは、Microsoft Visual Studio 2013 と Windows Driver Kit (WDK) 8.1 を使って作成したドライバー プロジェクトを、Visual Studio 2015 と Windows Driver Kit (WDK) 10 でビルドするドライバー プロジェクトに変換する方法を説明します。

Visual Studio 2015 では、コンパイラに新しい警告とエラーが追加されています。 Visual Studio 2013 ではエラーなしでビルドできていたドライバー プロジェクトでも、Visual Studio 2015 でビルドするとエラーが発生することがあります。

ドライバー ソリューション内のプロジェクトを変換するには、次の手順を実行します。

1.  Visual Studio 2015 で、レガシ ドライバー ソリューションを開きます。

    Visual Studio で自動的に ProjectUpgradeTool が実行され、ソリューション内のプロジェクトが変換されます。 このツールはコマンド プロンプトから実行することもできます。 既定では、WDK をインストールするときに ProjectUpgradeTool.exe を Windows Kits\\10\\bin\\x86 にインストールします。

    Visual Studio で **[ソリューション操作の再ターゲット]** ダイアログが開き、"**VC++ コンパイラとライブラリをアップグレードします**" というタイトルが表示されます。 **[OK]** をクリックすると、ソリューション内のすべてのプロジェクトのアップグレードが試みられます。

    **[ファイル変更の検出]** ダイアログが表示された場合は、**[すべて再読み込み]** をクリックします。

2.  [ソリューション エクスプローラー] ウィンドウで、ドライバー プロジェクト名を右クリックし、**[プロパティ]** をクリックします。 **[構成マネージャー]** ボタンをクリックします。 **[アクティブ ソリューション構成]** の一覧で、**[&lt;新規作成...&gt;]** をクリックします。 名前を入力し、Windows 8.1 プロジェクトのコンテキストから設定をコピーします。 **[OK]** をクリックします。

    一般に、変換元のソリューションには、デバッグ (テスト) 用とリリース用の 2 つの構成プロファイルが含まれます。 WDK 10 で同様の環境を作成するには、**[&lt;新規作成...&gt;]** を 2 回クリックします。 デバッグ プロファイルを作成するには、**Win 8.1 Debug** プロファイルからコピーします。 リリース プロファイルを作成するには、**Win 8.1 Release** プロファイルからコピーします。

3.  WDK 10 より前のバージョンの WDK では、ドライバー ソリューションには必ずパッケージ プロジェクトが必要でした。 WDK 10 では、1 つのドライバー パッケージに複数のドライバーを含める場合にのみパッケージ プロジェクトが必要となります。 次のガイドラインに従ってください。

    -   ソリューション内のドライバーが 1 つだけの場合は、パッケージ プロジェクトが含まれていれば削除します。

    -   ソリューション内に複数のドライバーがある場合は、ソリューションにパッケージ プロジェクトが含まれていることを確認します。 次に、ソリューション内の各ドライバー プロジェクトについて、プロジェクトのプロパティを開き、**[構成プロパティ] &gt; [ドライバーの設定]** に移動します。 **[パッケージのビルド]** を **[いいえ]** に設定します。 コマンド ラインからビルドする場合は、**/p:SupportsPackaging=false** を指定します。

4.  ドライバー プロジェクトの **[プロパティ]** をもう一度選択します。 **[構成プロパティ] &gt; [ドライバーの設定] &gt; [全般] &gt; [ターゲットの OS バージョン]** の順に移動します。 Windows 10 を選びます。

    **[ターゲット プラットフォーム]** が **[デスクトップ]** に設定されていることを確認し、ソリューションをビルドします。 エラーが発生した場合はすべて修正します。

5.  ソリューションのビルドに成功したら、**[ターゲット プラットフォーム]** を **[ユニバーサル]** に変更します。

    もう一度ソリューションをビルドします。 この時点で発生するエラーは、ApiValidator ツールから報告されるものだけです。このツールは、ドライバーがユニバーサル以外の機能を呼び出していないかどうかをチェックします。 非ユニバーサル DDI の呼び出しがある場合は、すべてユニバーサル DDI の呼び出しに置き換えます。

    ApiValidator について詳しくは、「[ユニバーサル Windows ドライバーの検証](validating-universal-drivers.md)」をご覧ください。

    特定の DDI のターゲット プラットフォームを判断する方法については、「[ドライバー リファレンス ページでのターゲット プラットフォーム](windows-10-editions-for-universal-drivers.md)」をご覧ください。

 

 





