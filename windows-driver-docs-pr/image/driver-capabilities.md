---
title: WIA ミニドライバーの機能
description: すべての WIA ミニドライバーは、通知イベントとコマンドを処理するデバイスの機能を定義する必要があります。 このセクションでは、これらのミニドライバー機能について説明します。
ms.assetid: 639eff56-655d-4b6a-95f0-daa1daf62fae
ms.date: 07/06/2020
ms.localizationpriority: medium
ms.openlocfilehash: 2d3ce8f017e75210e583a375d8c154d9563d0483
ms.sourcegitcommit: 40d7d538756767d26bbda636589f614f85a6fab3
ms.contentlocale: ja-JP
ms.lasthandoff: 07/06/2020
ms.locfileid: "86020066"
---
# <a name="wia-minidriver-capabilities"></a>WIA ミニドライバーの機能

すべての WIA ミニドライバーは、通知イベントとコマンドを処理するデバイスの機能を定義する必要があります。 このセクションでは、これらのミニドライバー機能について説明します。

WIA ミニドライバーは、サポートされているすべてのイベントとコマンドを一覧表示するテーブルを作成する役割を担います。 次の図は、WIA ミニドライバーがビルドする機能テーブルを示しています。

![wia ミニドライバー capabilities テーブルを示す図](images/wia-capabilitiestable.png)

Capabilities テーブルは、 [**WIA \_ DEV \_ CAP の \_ DRV**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wiamindr_lh/ns-wiamindr_lh-_wia_dev_cap_drv)構造体の配列として定義されています。 ミニドライバーはこの配列を構築し、wia サービスが[**IWiaMiniDrv::D rvgetcapabilities**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wiamindr_lh/nf-wiamindr_lh-iwiaminidrv-drvgetcapabilities)メソッドを呼び出したときにそれを wia サービスに返す必要があります。

## <a name="defining-supported-events-and-commands"></a>サポートされているイベントとコマンドの定義

WIA ミニドライバーは、デバイスが WIA サービスに対してサポートするイベントとコマンドを記述する必要があります。

### <a name="events"></a>イベント

*イベント*は、デバイスレベルのアクションであり、ドライバーに報告する必要があります。 たとえば、スキャナーに "Scan" というラベルが付いた前面パネルボタンがあるとします。 ユーザーがこのボタンを押すと、スキャナーがスキャンを開始するか、少なくともアプリケーションがスキャンの開始を開始することが期待されます。

WIA では、次の2種類のイベントがサポートされています。

- **アクションイベント:***アクションイベント*は、このようなイベントを処理するために登録されているアプリケーションを開始します。 たとえば、Microsoft スキャナーとカメラウィザードは、スキャンイベントの登録済みハンドラーです (他のアプリケーションもこのイベントに登録できます)。 ドライバーがスキャンイベントを送信すると、このイベントを処理するために、スキャナーとカメラのウィザードが開始されます。 この種類のイベントは、"*永続的なイベント*" と呼ばれることがよくあります。

- **通知イベント:***Notification イベント*は、既に実行中のアプリケーションに対してのみ送信され、このイベントを受信する必要があることを WIA サービスに示しています。 アプリケーションが実行されていない場合は、このイベントの処理は開始されません。

イベントには、アクションイベントと通知イベントの両方を指定できます。

### <a name="commands"></a>コマンド

WIA デバイスコマンドは、ミニドライバーに何らかのアクションを実行するように指示する wia ミニドライバーに対して (イメージングアプリケーションに代わって) 送信される要求です。 たとえば、WIA カメラミニドライバーは [**画像の撮影**] コマンドを処理する場合があります。 このコマンドは、デジタルカメラデバイスの注文をミニドライバーに指示して新しい画像を撮影するように指示します。

> [!NOTE]
> スキャナーとカメラのウィザードは、バックグラウンドでのクリーンアップがまだ行われている場合でも、すぐにユーザーに応答します。 たとえば、ユーザーが操作の取り消しを要求すると、スキャナーとカメラウィザードのウィンドウがすぐに閉じます。ただし、スキャナーとカメラウィザードには、ウィンドウが閉じられた後も引き続き実行される、個別の取得スレッドがあります。 この個別のスレッドによって、ユーザーの要求に対してすぐに応答できるようになりますが、ユーザーエクスペリエンスに影響を与えることなく、完了まで中断できない必要なタスクとタスクを実行できます。
